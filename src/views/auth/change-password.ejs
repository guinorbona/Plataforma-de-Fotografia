<%- include('../partials/header') %>
<%- include('../partials/navbar') %>

<main class="container auth-container">
  <h1>Alterar senha</h1>

  <% if (globalError) { %>
    <div class="form-card" style="border-color:#fb7185; margin-bottom:1rem;">
      <p style="color:#fb7185; margin:0;"><%= globalError %></p>
    </div>
  <% } %>

  <form action="/auth/alterar-senha" method="POST" class="form-card">
    <div class="form-group">
      <label for="currentPassword">Senha atual</label>
      <div class="password-wrapper">
      <input
        type="password"
        id="currentPassword"
        name="currentPassword"
        required
      />
      <span class="material-icons password-toggle">visibility</span>
      </div>
      <% if (errors && errors.currentPassword) { %>
        <small class="error"><%= errors.currentPassword %></small>
      <% } %>
    </div>

    <div class="form-group">
      <label for="newPassword">Nova senha</label>
      <div class="password-wrapper">
      <input
        type="password"
        id="newPassword"
        name="newPassword"
        required
        minlength="8"
        pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[^\\da-zA-Z]).{8,}$"
        title="Mínimo 8 caracteres, com letra maiúscula, minúscula, número e símbolo."
      />
      <span class="material-icons password-toggle">visibility</span>
      </div>
      <% if (errors && errors.newPassword) { %>
        <small class="error"><%= errors.newPassword %></small>
      <% } %>
    </div>

    <div class="form-group">
      <label for="confirmNewPassword">Confirmar nova senha</label>
    <div class="password-wrapper">
      <input
        type="password"
        id="confirmNewPassword"
        name="confirmNewPassword"
        required
      />
      <span class="material-icons password-toggle">visibility</span>
    </div>
      <% if (errors && errors.confirmNewPassword) { %>
        <small class="error"><%= errors.confirmNewPassword %></small>
      <% } %>
    </div>

    <button type="submit" class="btn btn-primary">Salvar nova senha</button>
  </form>
</main>

<%- include('../partials/footer') %>
